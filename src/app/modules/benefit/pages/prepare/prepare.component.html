<common-page-framework layout="blank">
    <!-- Question 1  Select the Tax Year -->

    <div class="row">
        <div class="col-md-8">
            <msp-tax-year [spaEnvResponse]="benefitApp.spaEnvRes" [currentTaxYear]="benefitApp.taxYear" (onTaxYearChange)="onTaxYearUpdate($event);"></msp-tax-year>
            
            <div *ngIf="benefitApp.taxYear"> 
        
            <h2  class='border-bottom' [innerHTML]="this.lang('./en/index.js').checkEligibilityScreenTitleDefault" tabindex="0">
            </h2>
        
            <form #formRef='ngForm' novalidate>
        
                <div class="form-group"
                        [ngClass]="{'has-error': !formRef.controls.netIncome?.valid && incomeRef.touched}">
                    <div class="row">
                        <div class="col-lg-12">
                            
                            <!-- Question 2, Enter your net income -->
                            <!-- <msp-common-income-inputtext 
                                [required]='true'
                                [(ngModel)]='benefitApp.netIncomelastYear'
                                #incomeRef
                                label=' new new Enter your net income – see Line 236 of your Notice of Assessment or Reassessment from Canada Revenue Agency.'>
                            </msp-common-income-inputtext> -->
                            <label for="netIncome">Enter your net income – see Line 236 of your Notice of Assessment or Reassessment from Canada Revenue Agency.</label>
        
                            <div class="col-md-6 input-group">
                                <div class="input-group-prepend">
                                    <span class="input-group-text">$</span>
                                </div>
                                <input type="text" class="form-control" name="netIncome" id="netIncome"
                                        [(ngModel)]="benefitApp.netIncomelastYear"
                                        #incomeRef="ngModel"
                                        pattern="^[0-9]{1}[0-9]{0,5}(\.[0-9]{1,2})?$"
                                        required maxlength="12">
                            </div>
        
                            <div *ngIf="(incomeRef.touched || incomeRef.dirty || (!!incomeRef.value && incomeRef.value.trim().length>0) || formRef.touched || !(benefitApp.ageOver65 === null || benefitApp.ageOver65 === undefined) ||
                                            formRef.controls.spouseIncomeLine236?.valid || benefitApp.spouseEligibleForDisabilityCredit)">
                                <div class="text-danger" *ngIf="(incomeRef.touched && incomeRef.errors?.required)"
                                        [innerHTML]="lang('./en/index.js').incomeDataRequired" tabindex="0"></div>
                                <div class="text-danger" *ngIf="incomeRef.errors?.pattern"
                                        [innerHTML]="lang('./en/index.js').invalidNumber" tabindex="0"></div>
                                <div class="text-danger" *ngIf="incomeRef.errors?.maxlength"
                                        [innerHTML]="lang('./en/index.js').incomeDataMaxLength" tabindex="0"></div>
                            </div>
                            
                        </div>



                    </div>
                </div>
                
        
                <!-- Question 3  Are you 65 or older -->
        
                <div class="form-group">
                    <common-radio [value]="benefitApp.ageOver65"  [label]="lang('./en/index.js').areYou65OrOlder" 
                        [radioLabels]='[{ "label": "No", "value": false}, {"label": "Yes", "value": true}]'
                        (statusChange)="dataService.benefitApp.ageOver65 = $event;">
                    </common-radio> 
                    
                </div>
        
                
                <div tabindex="-1" [hidden]="incomeRef.invalid || benefitApp.ageOver65 === null || benefitApp.ageOver65 === undefined">
        
                        <!-- Question 4 - Do you have a spouse   -->
                        <div class="form-group">
                            <common-radio [value]="benefitApp.hasSpouse"  label="Do you have a spouse or common-law partner?" 
                                [radioLabels]='[{ "label": "No", "value": false}, {"label": "Yes", "value": true}]'
                                (statusChange)="dataService.benefitApp.hasSpouse = $event;">
                            </common-radio>
                        </div>   
        
                        <!-- If applicant has a Spouse, optionally required -->
                        <div class="form-group" [hidden]="!benefitApp.hasSpouse">
                            
                            <!-- Spouse age 65 years   -->
                            <common-radio [value]="benefitApp.spouseAgeOver65"  [label]="lang('./en/index.js').isYourSpouseOrPartner65OrOlder" 
                                [radioLabels]='[{ "label": "No", "value": false}, {"label": "Yes", "value": true}]'
                                (statusChange)="dataService.benefitApp.spouseAgeOver65 = $event;">
                            </common-radio>
        
                            <!-- Spouse Income  -->
                            <label for="spouseIncomeLine236" [innerHtml]="lang('./en/index.js').whatIsYourSpouseOrPartnerIncome">
                            </label>
                            <div class="col-md-6 input-group">
                                <div class="input-group-prepend">
                                    <span class="input-group-text">$</span>
                                </div>
                                <input type="text" class="form-control" name="spouseIncomeLine236" id="spouseIncomeLine236"
                                        maxlength="12" #spouseIncomeRef="ngModel"
                                        pattern="^[0-9]{1}[0-9]{0,5}(\.[0-9]{1,2})?$"
                                        [(ngModel)]="benefitApp.spouseIncomeLine236">
                                        

                                <div *ngIf="(spouseIncomeRef.touched || spouseIncomeRef.dirty || (!!spouseIncomeRef.value && spouseIncomeRef.value.trim().length>0) || formRef.touched || !(benefitApp.ageOver65 === null || benefitApp.ageOver65 === undefined) ||
                                                formRef.controls.spouseIncomeLine236?.valid || benefitApp.spouseEligibleForDisabilityCredit)">
                                    <div class="text-danger" *ngIf="(spouseIncomeRef.touched && spouseIncomeRef.errors?.required)"
                                            [innerHTML]="lang('./en/index.js').incomeDataRequired" tabindex="0"></div>
                                    <div class="text-danger" *ngIf="spouseIncomeRef.errors?.pattern"
                                            [innerHTML]="lang('./en/index.js').invalidNumber" tabindex="0"></div>
                                    <div class="text-danger" *ngIf="spouseIncomeRef.errors?.maxlength"
                                            [innerHTML]="lang('./en/index.js').incomeDataMaxLength" tabindex="0"></div>
                                </div>
                                
                            </div>
                        </div>
                            
                        <!-- Question 4 - Have Childrens -->
                        <div class="form-group" *ngIf="benefitApp.ageOver65 != null || benefitApp.ageOver65 != undefined">
                            <common-radio [value]="benefitApp.haveChildrens"  [label]="'Do you have any children on your Medical Service Plan?'" 
                                [radioLabels]='[{ "label": "No", "value": false}, {"label": "Yes", "value": true}]'
                                (statusChange)="dataService.benefitApp.haveChildrens = $event; dataService.saveBenefitApplication();">
                            </common-radio>
                        </div>
                        
                        
                        <ng-container *ngIf="benefitApp.haveChildrens">
            
                                        <!-- Children Count-->        
                                        <div class="form-group row">
                                            <label class='col-md-12' for="childrenCount" [innerHtml]="lang('./en/index.js').howManyChildrenDoYouHaveOnYourMSP">
                                            </label>
                                            <div class="col-md-3" >
                                        
                                                <input type="text" class="form-control" name="childrenCount"
                                                    id="childrenCount"
                                                    maxlength="2"
                                                    [(ngModel)]="benefitApp.childrenCount">
                                            </div>
                                        </div>
                                
                                <!-- Claim for Child Care Expense -->     
                                <div class="form-group">
                                    <label for="line214"
                                        [innerHtml]="lang('./en/index.js').howMuchDidYouClaimForChildCareExpenseLastYear">
                                    </label>
            
                                    <div class="col-md-6 input-group">
                                        <div class="input-group-prepend">
                                            <span class="input-group-text">$</span>
                                        </div>
                                        <input type="text" class="form-control" id="line214" name="line214" placeholder=""
                                            pattern="^[0-9]{1}[0-9]{0,5}(\.[0-9]{1,2})?$"
                                            #line214Ref="ngModel"
                                            [(ngModel)]="benefitApp.claimedChildCareExpense_line214">
                                    </div>
            
                                    <div class="text-danger" *ngIf="line214Ref.errors?.pattern" [innerHTML]="lang('./en/index.js').invalidNumber"></div>
                                </div>
        
                                <!-- Report for UCC -->
                                <div class="form-group">
                                    <div class="row">
                                        <div class="col-lg-12">
                                            <label for="line117"
                                                [innerHtml]="lang('./en/index.js').howMuchDidYouReportForUCC">
                                            </label>
            
                                            <div class="col-md-6 input-group">
                                                <div class="input-group-prepend">
                                                    <span class="input-group-text">$</span>
                                                </div>
                                                <input type="text" class="form-control" name="line117" id="line117" placeholder=""
                                                    pattern="^[0-9]{1}[0-9]{0,5}(\.[0-9]{1,2})?$"
                                                    #line117Ref="ngModel"
                                                    [(ngModel)]="benefitApp.reportedUCCBenefit_line117">
                                            </div>
                                            <div class="text-danger" *ngIf="line117Ref.errors?.pattern" [innerHTML]="lang('./en/index.js').invalidNumber"></div>
            
                                        </div>
                                    </div>
                                </div>
            
                        </ng-container>
        
        
                        <!-- Question 4 - Report for UCC - Anyone included in your MSP coverage claim a disability tax credit-->
                        <div class="form-group" *ngIf="benefitApp.ageOver65 != null || benefitApp.ageOver65 != undefined">
                            <common-radio [value]="benefitApp.selfDisabilityCredit"  [label]="lang('./en/index.js').didAnyoneClaimDisabilityTaxCreditLastYear" 
                                [radioLabels]='[{ "label": "No", "value": false}, {"label": "Yes", "value": true}]'
                                (statusChange)="toggleClaimForSelfDisabilityCredit($event);">
                            </common-radio>
                            
                        </div>
        
                        
                    <div class="row" [hidden]="!benefitApp.selfDisabilityCredit" >
                            <div class="col-lg-12">
        
                                <div role="dialog" aria-labelledby="anyoneClaimeDisabilityQ">
                                    <label id="anyoneClaimeDisabilityQ" style="margin-bottom: 5px" > 
                                        Who claimed the attendant or nursing home expenses on last year's income tax return?
                                    </label>
                                    <div class="form-group d-flex">
                                        <div class="form-check form-check-inline">
                                            <input type="checkbox" tabindex="0"
                                                    name="applicantClaimForDisabilityCredit"
                                                    id="applicantClaimForDisabilityCredit"
                                                    [checked]="benefitApp.selfDisabilityCredit"
                                                    class='form-check-input'
                                                    (click)="toggleClaimForSelfDisabilityCredit($event)">
                                            <label for="applicantClaimForDisabilityCredit" class='form-check-label'>
                                                Myself
                                            </label>

                                        </div>
                                        <div class='form-check form-check-inline'>
                                            <div *ngIf="benefitApp.hasSpouse">
                                                <input type="checkbox" tabindex="0"
                                                    name="spouseClaimForDisabilityCredit"
                                                    id="spouseClaimForDisabilityCredit"
                                                    [checked]="benefitApp.spouseEligibleForDisabilityCredit"
                                                    class='form-check-input'
                                                    (click)="toggleClaimForSpouseDisabilityCredit($event)">
                                                <label for="spouseClaimForDisabilityCredit" class='form-check-label'>
                                                    My spouse/common-law partner
                                                </label>
                                            </div>
                                        </div>
                                    </div>
        
                                    <div class="form-group" *ngIf="(benefitApp.childrenCount > 0)">
                                        <label for="childWithDisabilityCount" >
                                                How many of your chilldren are eligible for disability credit?
                                        </label>
                                        <div class="col-lg-1" style="text-align:left; padding-left: 3px;">
                                            <input type="text" class="form-control" name="childWithDisabilityCount"
                                                    id="childWithDisabilityCount"
                                                    maxlength="2"
                                                    [ngModel]="benefitApp.childWithDisabilityCount"
                                                    (ngModelChange)= "updateChildDisabilityCreditCreditMultiplier($event)">
                                        </div>
                                        
                                    </div>
                                </div>
        
                            </div>
                        </div> 
                        <div class="row" [hidden]="!benefitApp.selfDisabilityCredit" style="margin-left: 5px; ">
        
                            <div class="col-lg-12">
                                <div class="form-group">
                                    <div class="row">
                                        
                                            <label for="line125">
                                                How much did you (or your spouse / common-law partner) report for a Registered Disability
                                                Savings Plan on your income tax return (Line 125)?
                                            </label>
        
                                            <div class="col-md-6 input-group">
                                                <div class="input-group-prepend">
                                                    <span class="input-group-text">$</span>
                                                </div>
                                                <input type="text" class="form-control" name="line125" id="line125"
                                                        pattern="^[0-9]{1}[0-9]{0,5}(\.[0-9]{1,2})?$"
                                                        #line125Ref="ngModel"
                                                        [(ngModel)]="benefitApp.spouseDSPAmount_line125">
                                            </div>
                                            <div class="text-danger" *ngIf="line125Ref.errors?.pattern" [innerHTML]="lang('./en/index.js').invalidNumber"></div>
        
                                        
                                    </div>
                                </div>
        
                            </div>
                        </div>   
                        
                        <!-- Question 5 - Anyone included in your MSP coverage claim attendant or nursing home expenses   -->
                        <div class="form-group" *ngIf="benefitApp.ageOver65 != null || benefitApp.ageOver65 != undefined">
                            <common-radio [value]="benefitApp.applicantClaimForAttendantCareExpense"  [label]="lang('./en/index.js').didAnyoneClaimAttendantCareLastYear" 
                                [radioLabels]='[{ "label": "No", "value": false}, {"label": "Yes", "value": true}]'
                                (statusChange)="dataService.benefitApp.applicantClaimForAttendantCareExpense = $event;">
                            </common-radio>
                            
                        </div>
        
                        <div [hidden]="!benefitApp.applicantClaimForAttendantCareExpense" style="margin-left: 15px; margin-top: 10px;"
                            role="dialog" aria-labelledby="anyoneClaimeAttendantCareQ">
                        <div class="row">
                            <div class="col-sm-12">
                                <label id="anyoneClaimeAttendantCareQ" style="margin-bottom: 5px"
                                        [innerHtml]="lang('./en/index.js').didAnyoneClaimAttendantCareLastYear">
                                </label>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-lg-3">
                                <div class="form-group">
                                    <div class="checkbox checkbox-success checkbox-inline">
                                        <input type="checkbox" tabindex="0"
                                                name="applicantClaimForAttendantCareExpense"
                                                id="applicantClaimForAttendantCareExpense"
                                                [ngModel]="benefitApp.applicantClaimForAttendantCareExpense"
                                                (click)="applicantClaimForAttendantCareExpense($event)">
                                        <label for="applicantClaimForAttendantCareExpense">
                                            Myself
                                        </label>
                                    </div>
                                </div>
                            </div>
                            <div class="col-lg-3" *ngIf="benefitApp.hasSpouse === true">
                                <div class="checkbox checkbox-success checkbox-inline">
                                    <div class="form-group">
                                        <input type="checkbox" tabindex="0"
                                                name="spouseClaimForAttendantCareExpense"
                                                id="spouseClaimForAttendantCareExpense"
                                                [ngModel] = "benefitApp.spouseClaimForAttendantCareExpense"
                                                (click)="spouseClaimForAttendantCareExpense($event)">
                                        <label for="spouseClaimForAttendantCareExpense">
                                            My spouse/common-law partner
                                        </label>
                                    </div>
                                </div>
                            </div>
                            <div class="col-lg-3"  *ngIf="!!benefitApp.childrenCount">
                                <div class="form-group">
                                    <div class="checkbox checkbox-success checkbox-inline">
                                        <input type="checkbox" tabindex="0"
                                            name="childClaimForAttendantCareExpense"
                                            id="childClaimForAttendantCareExpense"
                                            [ngModel] = "benefitApp.childClaimForAttendantCareExpense"
                                            (click) = "childClaimForAttendantCareExpense($event)">
                                        <label for="childClaimForAttendantCareExpense">
                                        My child
                                        </label>
                                    </div>
                                    </div>
                            </div>
        
                            <!-- Number of Children Claim for attendant care Expense   -->
                            <div class="col-lg-8" [hidden]="!benefitApp.childClaimForAttendantCareExpense || benefitApp.childrenCount < 2">
                                <div class="row">
                                    <div class="col-sm-12">
                                            <span>How many of your children who claimed for attendant care expense?</span>
                                            <span style="margin-left: 5px">
                                            <div class="col-lg-4" style="text-align:left; padding-left: 3px;"> 
                                                <input type="text" class="form-control" name="childClaimForAttendantCareExpenseCount"
                                                    id="childClaimForAttendantCareExpenseCount"
                                                    maxlength="2"
                                                    [(ngModel)]="benefitApp.childClaimForAttendantCareExpenseCount">
                                            </div>
                                        
                                            </span>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <!-- Expense receipt File Uploader -->
                        <div class="row" style="margin-top: 15px;" *ngIf="requireAttendantCareReceipts">
                            <div class="col-lg-12">
                                <label for="netIncome">Please upload your attendant care receipts for the expense entered above (required).</label>
                                <common-file-uploader #fileUploader
                                                    [images]="benefitApp.attendantCareExpenseReceipts"
                                                    [id]='benefitApp.id'
                                                    (onAddDocument)="addReceipts($event)"
                                                    (onErrorDocument)="errorReceipts($event)"
                                                    (onDeleteDocument)="deleteReceipts($event)">
                                    <span id="uploadInstruction"
                                    #uploadInstruction>
                                    Please upload documents for your expenses
                                    </span>
        
                                </common-file-uploader>
                                <msp-image-error-modal #mspImageErrorModal></msp-image-error-modal>
                            </div>
                        </div>
                    </div>
                </div>
            </form>
            </div> <!-- ngif check end -->
        </div>
        <div class='col-md-4'>
            <msp-common-deduction-calculator (continue)="canContinue($event)"
                                             [eligibilityCalculatorTitle]="lang('./en/index.js').eligibilityCalculatorTitle"
                                             [application]="benefitApp"
                                             [qualificationThreshhold]="qualificationThreshhold"
                                             [totalHouseholdIncomeLabel]="lang('./en/index.js').totalHouseholdIncome"
                                             [continueButtonLabel]="lang('./en/index.js').continueButtonLabel"
                                             [NotQualifyText]="lang('./en/index.js').mayNotQualifyText"
                                             (taxYearInfoMissing)="onTaxYearInfoMissing()"
                                             [disableContinue]="true">
            </msp-common-deduction-calculator>
        </div>
    </div>

        <!-- Calculator -->
        <!-- <div class="col-lg-4">
            <msp-common-deduction-calculator  (continue)="canContinue($event)" 
                [eligibilityCalculatorTitle]="lang('./en/index.js').eligibilityCalculatorTitle" 
                [application]="benefitApp" [qualificationThreshhold] = "qualificationThreshhold"
                [totalHouseholdIncomeLabel] = "lang('./en/index.js').totalHouseholdIncome" 
                [continueButtonLabel] = "lang('./en/index.js').continueButtonLabel"  
                [NotQualifyText] = "lang('./en/index.js').mayNotQualifyText"
                (taxYearInfoMissing)= "onTaxYearInfoMissing()" 
                [disableContinue]="true">
            </msp-common-deduction-calculator>
         </div> -->

    

    
</common-page-framework>

<common-consent-modal #mspConsentModal [isUnderMaintenance]="true" (cutOffDate)= "spaEnvCutOffDate($event)"
        title="Information collection notice" agreeLabel="I have read and understand this information"
        [processName]="lang('./en/index.js').consentProcessName" (accept)="benefitApp.infoCollectionAgreement = $event; this.dataService.saveBenefitApplication();">
        <p><strong>Keep your personal information secure – especially when using a shared device like a computer at a library, school or café.</strong> To delete any information that was entered, either complete the application and submit it or, if you don’t finish, close the web browser.</p><p><strong>Need to take a break and come back later?</strong> The data you enter on this form is saved locally to the computer or device you are using until you close the web browser or submit your application.</p><p><strong>Information in this application is collected by the Ministry of Health</strong> under section 26(a), (c) and (e) of the Freedom of Information and Protection of Privacy Act and will be used to determine eligibility for provincial health care benefits in BC and administer Premium Assistance. Should you have any questions about the collection of this personal information please <a href="http://www2.gov.bc.ca/gov/content/health/health-drug-coverage/msp/bc-residents-contact-us" target="_blank">contact Health Insurance BC <i class="fa fa-external-link" aria-hidden="true"></i></a>.</p>
</common-consent-modal>         

<div bsModal #disabilityNursingHomeChoiceModal="bs-modal" class="modal fade" [config]="{backdrop: 'static'}"
     tabindex="0" role="dialog" aria-labelledby="disabilityNursingHomeChoiceModalLabel">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title pull-left">Claim either {{claimCategory}} or {{counterClaimCategory}}</h3>
                <button type="button" class="close pull-right" aria-label="Close" (click)="disabilityNursingHomeChoiceModal.hide()">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <div>
                    <p>
                        You have already selected <span class="msp-emphasis">{{counterClaimCategory}}</span> for {{claimant}}.
                    </p>
                    <p>
                        If you add <span class="msp-emphasis">{{claimCategory}}</span> for {{claimant}}, your {{counterClaimCategory}} will be removed.
                    </p>
                    <p>
                        Do you want to continue to add {{claimCategory}} for {{claimant}}?
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-primary btn-md pull-left" data-dismiss="modal" tabindex="0"
                        (click)="switchClaim(claimant, claimCategory, counterClaimCategory)">Yes, continue</button>
                <button type="button" class="btn btn-danger btn-md pull-right" data-dismiss="modal" tabindex="0"
                        (click)="disabilityNursingHomeChoiceModal.hide()">No, cancel</button>
            </div>
        </div>
    </div>
</div>

<common-form-action-bar [submitLabel]="'Apply for Supplementary Benefits'"
        [canContinue]="continue"
        (btnClick)="navigateToPersonalInfo()"
        widthOption='extra-width-mobile-only'>
</common-form-action-bar>